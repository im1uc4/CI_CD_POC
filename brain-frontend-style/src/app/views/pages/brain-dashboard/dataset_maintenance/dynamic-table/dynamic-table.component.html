<div class="row" *ngIf="formMode!='short'">
  <div class="col-sm-10">
        <button mat-button class="toolbar-button" color="primary" matTooltip="Back" type="button"  aria-labelledby="Back" (click)="returnBack()">
          <mat-icon>arrow_back_ios</mat-icon>
          <span>Back</span>
        </button>                 
  </div>        
</div>
<kt-portlet>
  <kt-portlet-header>
      <ng-container ktPortletTitle>
              <h2 style="font-size:1.8rem; font-weight: 600"><span class="black">{{ sequenceNum }}</span>{{ tableDisplayName }}</h2>
      </ng-container>
      <ng-container ktPortletTools>
          <mat-form-field *ngIf="tableName!='create_roster'" style="margin-right: 10px;">
              <input matInput type="text" (keyup)="doFilter($event.target.value)" placeholder="Search">
          </mat-form-field>
          <button mat-button *ngIf="tableName!='create_roster'" class="toolbar-button" color="primary" matTooltip="Delete" type="button" [disabled]="!isEditable"  aria-labelledby="Delete Selected Records" (click)="removeSelectedRows()">
            <span>Delete Selected Records</span>
            <mat-icon>delete_outline</mat-icon>
          </button>  
          <button mat-button *ngIf="tableName!='create_roster'" class="toolbar-button" color="primary"  matTooltip="Add" type="button"  [disabled]="!isEditable"  aria-labelledby="Add" (click)="addRecord()">
            <span>Add</span>
            <mat-icon>add_circle_outline</mat-icon>
          </button>
          <p>&nbsp;</p>
      </ng-container>
  </kt-portlet-header>
  <kt-portlet-body  *ngIf="tableName!='create_roster'">
      <!--<div class="horizontal-line col-md-12 kt-margin-bottom-12-mobile "> </div>-->
      <div class="mat-table__wrapper mat-table__wrapper--sub" [formGroup]="form">
          <mat-table #table table [dataSource]="dataModelDataSource" matSort>
              <ng-container matColumnDef="index">
                  <th mat-header-cell *matHeaderCellDef>S/N</th>
                  <td mat-cell *matCellDef="let element; let i = index;" >{{ i + 1 }}</td>
              </ng-container>   
              <ng-container *ngFor="let column of headersModel" matColumnDef="{{ column.columnName }}">
                <th mat-header-cell *matHeaderCellDef mat-sort-header [disabled]="isSortingDisabled(column.control_type)">{{ column.column_type==='button'? null: (column.is_mandatory?column.displayName+'*':column.displayName) }}</th>       
                <td mat-cell *matCellDef="let element; let i = index;"> 
                  <mat-form-field class="mat-form-field-fluid" *ngIf="column.control_type==='textbox'&&element.hasOwnProperty(column.columnName)">
                      <!--Dynamic controls depends on field type-->
                      <input matInput [type]="(column.column_type==='numeric'?'number':'text')" value="{{ element[column.columnName] }}" [formControlName]="element['record_id'] + column.columnName" [readonly]="!column.is_editable" placeholder="Please enter {{column.displayName}}" autocomplete="off" (change)="ValueChange(element,column.columnName,$event.target.value)">                   
                      <mat-error *ngIf="form.controls[element['record_id'] + column.columnName].hasError('required')&&form.controls[element['record_id'] + column.columnName].touched">
                        <strong>{{ 'AUTH.VALIDATION.REQUIRED_FIELD' | translate }}</strong>
                      </mat-error>
                      <mat-error *ngIf="form.controls[element['record_id'] + column.columnName].hasError('idUniq')&&form.controls[element['record_id'] + column.columnName].touched">
                        <strong>{{ column.columnName }} is not unique</strong>
                      </mat-error>
                    </mat-form-field>
                  <mat-form-field class="mat-form-field-fluid" *ngIf="column.control_type==='calendar'&&element.hasOwnProperty(column.columnName)">
                      <input matInput [owlDateTimeTrigger]="picker" [owlDateTime]="picker" [formControlName]="element['record_id'] + column.columnName" placeholder="Please enter {{ column.displayName }}" [value]="convertStringToDate(element[column.columnName])" (dateTimeInput)="ValueChange(element,column.columnName,$event.value._d,'datetimepicker')">
                      <owl-date-time #picker></owl-date-time>   
                      <mat-error >
                        <strong>{{ 'AUTH.VALIDATION.REQUIRED_FIELD' | translate }}</strong>
                      </mat-error>   
                  </mat-form-field> 
                  <mat-form-field class="mat-form-field-fluid" *ngIf="column.control_type==='dropdownlist'&&column.columnName==='resourceId'&&element.hasOwnProperty(column.columnName)"> 
                      <mat-select placeholder = "Please enter {{ column.displayName }}" [value]="element[column.columnName]"  (selectionChange)="ValueChange(element,column.columnName,$event, 'dropdownlist')" [formControlName]="element['record_id'] + column.columnName">
                        <mat-option [value] ="empty_value">{{empty_value}}</mat-option>
                        <mat-option *ngFor = "let resource of resourceDDL" [value] = "resource.resourceId">
                            {{resource.resourceName}} ({{resource.resourceId}})
                        </mat-option>
                      </mat-select>
                      <mat-error >
                        <strong>{{ 'AUTH.VALIDATION.REQUIRED_FIELD' | translate }}</strong>
                      </mat-error>
                  </mat-form-field>  
                  <mat-form-field class="mat-form-field-fluid" *ngIf="column.control_type==='dropdownlist'&&column.columnName==='serviceId'&&element.hasOwnProperty(column.columnName)"> 
                      <mat-select placeholder = "Please enter {{ column.displayName }}" [value]="element[column.columnName]"  (selectionChange)="ValueChange(element,column.columnName,$event, 'dropdownlist')" [formControlName]="element['record_id'] + column.columnName">
                        <mat-option *ngFor = "let service of serviceDDL" [value] = "service.serviceId">
                          {{service.serviceName}} ({{service.serviceId}})
                        </mat-option>
                      </mat-select>
                      <mat-error >
                        <strong>{{ 'AUTH.VALIDATION.REQUIRED_FIELD' | translate }}</strong>
                      </mat-error>
                  </mat-form-field>    
                  <button mat-button class="toolbar-button" color="primary" type="button" *ngIf="column.control_type==='button'" [disabled]="!column.is_editable" (click)="openDialog(element,element[column.columnName])">
                    <span>{{ element[column.columnName] }}</span>
                  </button> 
                  <mat-checkbox [disableRipple]="true" *ngIf="column.control_type==='checkbox'" [checked]="element[column.columnName] === 'true'" (change)="ValueChange(element,column.columnName,$event,column.control_type)">
                  </mat-checkbox>  
                </td>
              </ng-container>
              <ng-container matColumnDef="select">
                <th mat-header-cell *matHeaderCellDef>Delete</th>
                <td mat-cell *matCellDef="let element" class="mat-column-checkbox" >
                  <mat-checkbox         
                      [checked]="element['status']"
                      [color]="'primary'"
                      [disabled]="!isEditable" 
                      (click)="selection.toggle(element)"
                      ></mat-checkbox>
                </td>
              </ng-container> 

              <tr mat-header-row *matHeaderRowDef="displayColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayColumns; let i = index"></tr>
            </mat-table>
             <div class="mat-table__message" *ngIf="dataModelDataSource?.data.length===0">No records found</div><!-- Message for empty data  -->      </div>           
            <div class="col-md-12">  
              <button mat-button (click)="openFullPageView(tableDisplayName,jobId)" *ngIf="formMode==='short'" style="float: left;"><p style="margin: 0px; font-size: 0.8rem">View all other {{ tableDisplayName }}</p></button>
            </div>  
      <div class="mat-table__bottom">
            <mat-paginator #paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 15]" [length]="dataModelDataSource?.data.length"  [showFirstLastButtons]="true" *ngIf="formMode==='short'" style="visibility:hidden"></mat-paginator>
            <mat-paginator #paginator [pageSize]="15" [pageSizeOptions]="[15, 20, 50]"  [length]="dataModelDataSource?.data.length" [showFirstLastButtons]="true" *ngIf="formMode!='short'" ></mat-paginator>
      </div>
            <!--
            <div class="row  col-md-12 align-items-right">
                    <a [routerLink]="['../../']" class="btn btn-secondary kt-margin-r-10"  mat-raised-button matTooltip="Back to the data maintenance">
                      <i class="la la-arrow-left"></i>
                      <span class="kt-hidden-mobile">Back</span>
                    </a>
            </div> -->
    </kt-portlet-body>
      <kt-portlet-body *ngIf="tableName==='create_roster'">
        <div class="row col-md-12">  
            <div class="col-md-10"> 
            </div>
            <div class="col-md-2 kt-login__actions"> 
                <button mat-button class="btn btn-bold btn-label-brand btn-sm" [disabled]="isDisabled" style="float: right;" color="primary" matTooltip="Create Roster" type="button"  aria-labelledby="Create Roster" (click)="generateSchedule()"  style="float: right;"><span>Create Roster</span></button>
          </div>
        </div>
        <!--<ng-container ktPortletTools> 
          <button mat-button class="btn btn-bold btn-label-brand btn-sm" color="primary" matTooltip="Delete" type="button"  aria-labelledby="v" (click)="createRoster()"><span>Create Roster</span></button>
        </ng-container>--> 
      </kt-portlet-body>
  </kt-portlet>
